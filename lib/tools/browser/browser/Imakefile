OzLib      = $(OZHOME)/lib
BrowserLib = $(OzLib)/browser

LOCALMODULES =  XResources.oz browserObject.oz browserTerm.oz \
                bufs&streams.oz constants.oz controlObject.oz core.oz \
                errors.oz managerObject.oz reflect.oz repManager.oz \
                store.oz tcl-interface.oz termObject.oz \
                termsStore.oz undefs.oz windowManager.oz

AUXFILES =

LIBMODULES = ${LOCALMODULES:%.oz=$(BrowserLib)/%.oz}
AUXMODULES = ${AUXFILES:%.txt=$(BrowserLib)/%.txt}

all:: ../Browser.oz

../Browser.oz: $(LOCALMODULES)
        touch ../Browser.oz

install:: $(BrowserLib) $(LIBMODULES) $(AUXMODULES) bitmaps

bitmaps: $(OzLib)/bitmaps
        $(INSTALL) -m 444 ../bitmaps/browserMIcon.xbm $(OzLib)/bitmaps
        $(INSTALL) -m 444 ../bitmaps/browserIcon.xbm  $(OzLib)/bitmaps
        $(INSTALL) -m 444 ../bitmaps/stop.xbm  $(OzLib)/bitmaps

$(BrowserLib):
        install -m 775 -d $@

$(BrowserLib)/%.oz: %.oz
        $(INSTALLSRC) '$<' '$@'

$(BrowserLib)/%.txt: %.txt
        install -m 444 '$<' '$@'

undefs: constants.oz
        rm -f undefs.oz
        egrep '^\\define' constants.oz | sed -e '1,$$s/define/undef/g' > undefs.oz
